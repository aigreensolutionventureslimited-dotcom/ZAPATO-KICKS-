<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Zapato Kicks | Collection</title>

<link href="https://fonts.googleapis.com/css2?family=Syne:wght@800&family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

<style>
:root{
  --bg:#030303;
  --accent:#c5a059;
  --text:#fff;
  --border:rgba(255,255,255,.08);
}
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:'Inter',sans-serif;background:var(--bg);color:var(--text)}

nav{
  position:fixed;top:0;width:100%;
  padding:18px 5%;
  display:flex;justify-content:space-between;align-items:center;
  background:rgba(3,3,3,.9);backdrop-filter:blur(15px);
  z-index:1000;border-bottom:1px solid var(--border)
}
.logo{font-family:'Syne';letter-spacing:2px;color:var(--accent)}
.vault-btn{font-size:.7rem;font-weight:700;background:#fff;color:#000;padding:8px 15px;border-radius:20px}

.filters{
  display:flex;gap:20px;padding:100px 5% 20px;
  overflow-x:auto
}
.f-btn{background:none;border:none;color:#555;font-size:.7rem;font-weight:700}
.f-btn.active{color:var(--accent)}

.grid{
  display:grid;
  grid-template-columns:repeat(2,1fr);
  gap:12px;
  padding:0 5% 120px
}
.card img{
  width:100%;aspect-ratio:1/1.2;
  object-fit:cover;background:#0a0a0a
}
.card-name{font-size:.7rem;margin-top:8px;opacity:.8}
.card-price{font-size:.85rem;font-weight:700;color:var(--accent)}

.modal,.overlay,.zoom{
  position:fixed;inset:0;background:#000;
  display:none;z-index:2000
}

.slider{overflow:hidden}
.slider-track{display:flex;transition:.3s ease}
.slider-track img{width:100%;flex-shrink:0}

.dots{display:flex;justify-content:center;gap:6px;margin:10px 0}
.dot{width:6px;height:6px;border-radius:50%;background:#555}
.dot.active{background:var(--accent)}

.details{padding:30px 5% 120px}

.buy-bar{
  position:fixed;bottom:0;width:100%;
  padding:20px 5%;
  background:rgba(3,3,3,.9);
  backdrop-filter:blur(10px);
  border-top:1px solid var(--border)
}

.action-btn{
  width:100%;padding:18px;
  border:none;border-radius:4px;
  background:#fff;color:#000;
  font-weight:800
}

.overlay{padding:40px 5%}

.pay-card{
  background:#111;padding:25px;
  border:1px solid var(--border);
  border-radius:8px
}
.bank-box{
  background:#000;padding:20px;
  border-left:3px solid var(--accent);
  margin:20px 0
}
.bank-box p{font-size:.8rem;color:#888}
.bank-box h4{letter-spacing:1px}

input{
  width:100%;padding:15px;
  background:#000;color:#fff;
  border:1px solid #222;
  margin-bottom:10px
}

.zoom img{width:100%;height:100%;object-fit:contain}
</style>
</head>

<body>

<nav>
  <div class="logo">ZAPATO VAULT</div>
  <div class="vault-btn" onclick="openCheckout()">CHECKOUT (<span id="count">0</span>)</div>
</nav>

<div class="filters">
  <button class="f-btn active" onclick="filterCat('All',this)">All</button>
  <button class="f-btn" onclick="filterCat('Sneakers',this)">Sneakers</button>
  <button class="f-btn" onclick="filterCat('Corporate',this)">Corporate</button>
  <button class="f-btn" onclick="filterCat('Palms',this)">Palms</button>
  <button class="f-btn" onclick="filterCat('Slides',this)">Slides</button>
</div>

<div class="grid" id="grid"></div>

<div id="productModal" class="modal"></div>

<div id="checkoutModal" class="overlay">
  <h2 style="font-family:'Syne';margin-bottom:20px">CHECKOUT</h2>
  <div class="pay-card">
    <p style="font-size:.8rem">Transfer to:</p>
    <div class="bank-box">
      <p>Moniepoint MFB</p>
      <h4>8164082531</h4>
      <p>Account Name</p>
      <h4 style="color:var(--accent)">ZAPATO KICKS</h4>
    </div>
    <input id="cName" placeholder="Your Full Name">
    <input id="cAddress" placeholder="Delivery Address">
    <button class="action-btn" onclick="sendOrder()">I HAVE PAID (WHATSAPP)</button>
    <button onclick="checkoutModal.style.display='none'"
      style="background:none;border:none;color:#555;width:100%;margin-top:15px;font-size:.7rem">
      CANCEL
    </button>
  </div>
</div>

<div class="zoom" id="zoom" onclick="zoom.style.display='none'">
  <img id="zoomImg">
</div>

<script>
const supa = supabase.createClient(
  'https://rvfuenrggxverrnnmcet.supabase.co',
  'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InJ2ZnVlbnJnZ3h2ZXJybm5tY2V0Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njc4Njc2MTcsImV4cCI6MjA4MzQ0MzYxN30.aKCaWeXR1Le68waDqG_UHiOOZpkZYNC2FTTMutY-CqI'
);

const grid = document.getElementById('grid');
const productModal = document.getElementById('productModal');
const checkoutModal = document.getElementById('checkoutModal');
const zoom = document.getElementById('zoom');
const zoomImg = document.getElementById('zoomImg');
const count = document.getElementById('count');

let products=[], cart=[], slideIndex=0;

async function load(){
  const {data,error}=await supa.from('products').select('*').order('created_at',{ascending:false});
  if(error){console.error(error);return}
  products=data; render(products);
}

function render(items){
  grid.innerHTML = items.map((p,i)=>`
    <div class="card" onclick="openProduct(${i})">
      <img src="${p.image_front}">
      <div class="card-name">${p.name}</div>
      <div class="card-price">₦${p.price.toLocaleString()}</div>
    </div>
  `).join('');
}

function openProduct(i){
  const p=products[i];
  slideIndex=0;

  productModal.innerHTML=`
    <div class="slider">
      <div class="slider-track" id="track">
        <img src="${p.image_front}" onclick="zoomImg.src=this.src;zoom.style.display='block'">
        <img src="${p.image_back}" onclick="zoomImg.src=this.src;zoom.style.display='block'">
      </div>
    </div>

    <div class="dots">
      <div class="dot active"></div>
      <div class="dot"></div>
    </div>

    <div class="details">
      <h1 style="font-family:'Syne'">${p.name}</h1>
      <p style="color:var(--accent);font-weight:700">₦${p.price.toLocaleString()}</p>
    </div>

    <div class="buy-bar">
      <button class="action-btn" onclick="addToCart(${i})">ADD TO VAULT</button>
      <button onclick="productModal.style.display='none'"
        style="background:none;border:none;color:#555;width:100%;margin-top:10px;font-size:.7rem">
        CLOSE
      </button>
    </div>
  `;
  productModal.style.display='block';
  initSlider();
}

function initSlider(){
  const track=document.getElementById('track');
  const dots=document.querySelectorAll('.dot');
  let startX=0;

  track.addEventListener('touchstart',e=>startX=e.touches[0].clientX);
  track.addEventListener('touchend',e=>{
    let diff=e.changedTouches[0].clientX-startX;
    if(diff<-50 && slideIndex<1) slideIndex++;
    if(diff>50 && slideIndex>0) slideIndex--;
    track.style.transform=`translateX(-${slideIndex*100}%)`;
    dots.forEach(d=>d.classList.remove('active'));
    dots[slideIndex].classList.add('active');
  });
}

function addToCart(i){
  cart.push(products[i]);
  count.innerText=cart.length;
  productModal.style.display='none';
}

function openCheckout(){
  if(!cart.length) return alert('Vault is empty');
  checkoutModal.style.display='block';
}

function sendOrder(){
  const n=cName.value,a=cAddress.value;
  if(!n||!a) return alert('Fill details');
  const items=cart.map(i=>`- ${i.name}`).join('%0A');
  const total=cart.reduce((s,i)=>s+i.price,0);
  window.open(`https://wa.me/2349061996801?text=*ZAPATO KICKS ORDER*%0A*Name:* ${n}%0A*Address:* ${a}%0A%0A${items}%0A%0A*Total:* ₦${total.toLocaleString()}`);
  cart=[];count.innerText=0;checkoutModal.style.display='none';
}

function filterCat(cat,btn){
  document.querySelectorAll('.f-btn').forEach(b=>b.classList.remove('active'));
  btn.classList.add('active');
  render(cat==='All'?products:products.filter(p=>p.cat===cat));
}

load();
</script>

</body>
</html>
